<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Specs - SFCDD</title>
    <!-- Favicon -->
    <!-- Modern browsers -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <!-- Fallback for older browsers -->
    <link rel="icon" type="image/png" href="/favicon.png" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-blue: #017dc3;
        --primary-yellow: #fdb813;
        --primary-green: #8ac73e;
        --faded-blue: #8bbbd8;
        --faded-yellow: #fae8c6;
        --faded-green: #b8dc8f;
        --navbar-height: 72px;
      }

      /* Make html and body full height */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }

      /* Make navbar fixed at top */
      #navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        height: var(--navbar-height);
      }

      main.container {
        position: fixed;
        top: var(--navbar-height);
        left: 0;
        right: 0;
        bottom: 0;
        height: calc(100vh - var(--navbar-height));
        overflow-y: auto;
        padding: 2rem 2rem 2rem 2rem;
        max-width: 100%;
        box-sizing: border-box;
      }

      /* Mobile-specific compact padding */
      @media (max-width: 575px) {
        main.container {
          padding: 0.5rem;
        }

        h1 {
          font-size: 1.25rem;
          margin-bottom: 0.5rem !important;
        }
      }

      /* Add padding for container content */
      @media (min-width: 576px) {
        main.container {
          padding-left: calc((100% - 540px) / 2 + 2rem);
          padding-right: calc((100% - 540px) / 2 + 2rem);
        }
      }

      @media (min-width: 768px) {
        main.container {
          padding-left: calc((100% - 720px) / 2 + 2rem);
          padding-right: calc((100% - 720px) / 2 + 2rem);
        }
      }

      @media (min-width: 992px) {
        main.container {
          padding-left: calc((100% - 960px) / 2 + 2rem);
          padding-right: calc((100% - 960px) / 2 + 2rem);
        }
      }

      @media (min-width: 1200px) {
        main.container {
          padding-left: calc((100% - 1140px) / 2 + 2rem);
          padding-right: calc((100% - 1140px) / 2 + 2rem);
        }
      }

      @media (min-width: 1400px) {
        main.container {
          padding-left: calc((100% - 1320px) / 2 + 2rem);
          padding-right: calc((100% - 1320px) / 2 + 2rem);
        }
      }

      /* Spec items */
      .spec-item {
        display: block;
        padding: 0.75rem 1rem;
        border-bottom: 1px solid #e0e0e0;
        transition: background-color 0.2s ease;
        text-decoration: none;
        color: inherit;
        cursor: pointer;
      }

      /* Mobile-specific compact spec items */
      @media (max-width: 575px) {
        .spec-item {
          padding: 0.5rem 0.5rem;
          flex-direction: column;
          align-items: flex-start !important;
        }

        .spec-number {
          font-size: 0.85rem;
        }

        .spec-title {
          font-size: 0.8rem;
          margin-left: 0 !important;
          margin-top: 0.25rem;
        }
      }

      .spec-item:hover {
        background-color: var(--faded-yellow);
        text-decoration: none;
      }
      .spec-item:last-child {
        border-bottom: none;
      }
      .spec-number {
        font-weight: 600;
        color: var(--primary-blue);
        user-select: text;
        cursor: text;
        min-width: 120px;
      }
      .spec-title {
        color: #333;
        margin-left: 1rem;
        user-select: text;
        cursor: text;
      }

      .specs-list {
        background-color: white;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
      }
    </style>
  </head>
  <body>
    <!-- Navigation bar container -->
    <nav id="navbar"></nav>

    <main class="container mt-4">
      <div id="specsList" class="specs-list">
        <!-- Specs will be populated by JavaScript -->
      </div>
    </main>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Include the navbar JavaScript -->
    <script src="../tools/navbar.js"></script>
    <script>
      // Load navbar with page title
      document.addEventListener("DOMContentLoaded", () =>
        loadNavbar("Standard Specifications")
      );

      // Load and display specs data
      async function loadSpecs() {
        try {
          const response = await fetch("specs.json");
          const data = await response.json();

          const specsList = document.getElementById("specsList");
          let specsHTML = "";

          // Loop through sections
          data.sections.forEach((section) => {
            // Use file_name if provided, otherwise use section_number with spaces replaced by underscores
            const fileName =
              section.file_name || section.section_number.replace(/ /g, "_");
            const viewerPath = `/tools/doc_viewer.html?pdf=${fileName}&source=specs&back=/standards/specs.html`;
            specsHTML += `
              <div class="spec-item d-flex align-items-center" data-href="${viewerPath}">
                <span class="spec-number">${section.section_number}</span>
                <span class="spec-title flex-grow-1">${section.title}</span>
              </div>
            `;
          });

          specsList.innerHTML = specsHTML;

          // Add click handlers to spec items
          document.querySelectorAll(".spec-item").forEach((item) => {
            item.addEventListener("mousedown", function (e) {
              this.dataset.mouseDownTime = Date.now();
              this.dataset.mouseDownX = e.clientX;
              this.dataset.mouseDownY = e.clientY;
            });

            item.addEventListener("mouseup", function (e) {
              const mouseUpTime = Date.now();
              const timeDiff =
                mouseUpTime - parseInt(this.dataset.mouseDownTime);
              const xDiff = Math.abs(
                e.clientX - parseInt(this.dataset.mouseDownX)
              );
              const yDiff = Math.abs(
                e.clientY - parseInt(this.dataset.mouseDownY)
              );

              // Only navigate if it's a quick click without much movement (not a text selection)
              if (timeDiff < 300 && xDiff < 5 && yDiff < 5) {
                const selection = window.getSelection();
                if (!selection.toString()) {
                  window.open(this.dataset.href, "_blank");
                }
              }
            });
          });
        } catch (error) {
          console.error("Error loading specs:", error);
          document.getElementById("specsList").innerHTML = `
            <div class="alert alert-danger" role="alert">
              Error loading specifications data. Please try again later.
            </div>
          `;
        }
      }

      // Load specs when DOM is ready
      document.addEventListener("DOMContentLoaded", loadSpecs);
    </script>
  </body>
</html>
